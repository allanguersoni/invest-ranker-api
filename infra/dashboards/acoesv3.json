{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 3,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "afei7jijkor9cc"
      },
      "description": "O que √©: O ranking definitivo das a√ß√µes mais baratas e eficientes da bolsa, usando o algoritmo de Benjamin Graham (mentor de Warren Buffett). O rob√¥ cruza o \"Pre√ßo Justo\" (baseado no patrim√¥nio e lucro da empresa) com a efici√™ncia de gest√£o (ROE).\n\nComo ler: Foco na coluna \"Margem (%)\". Ela indica o seu \"colch√£o de seguran√ßa\".\nExemplo Pr√°tico: Se o algoritmo calculou que o Pre√ßo Justo do Banco do Brasil √© R$ 60,00, mas a cota√ß√£o atual na tela est√° R$ 30,00, a Margem de Seguran√ßa √© de 100%. Significa que voc√™ est√° comprando uma nota de 100 Reais pagando apenas 50 Reais. A recomenda√ß√£o \"COMPRA FORTE üöÄ\" exige no m√≠nimo 30% de margem e um ROE (lucratividade) acima de 10%.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "orange",
                "value": 50
              },
              {
                "color": "green",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGRES}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT \r\n  score as \"Score IA\",\r\n  recomendacao as \"Recomenda√ß√£o\",\r\n  ticker as \"A√ß√£o\", \r\n  cotacao_atual as \"Cota√ß√£o (R$)\", \r\n  preco_justo_graham as \"Pre√ßo Justo (R$)\",\r\n  margem_seguranca as \"Margem (%)\",\r\n  pl as \"P/L\",\r\n  roe as \"ROE (%)\",\r\n  TO_CHAR(data_atualizacao, 'DD/MM/YYYY HH24:MI') as \"√öltima Leitura\"\r\nFROM acao \r\nWHERE score > 0 AND pl > 0 AND margem_seguranca > 0\r\nORDER BY score DESC, margem_seguranca DESC \r\nLIMIT 50;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "üèÜ Top Oportunidades (F√≥rmula de Graham)",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "afei7jijkor9cc"
      },
      "description": "O que √©: O filtro anti-armadilhas para quem busca renda passiva (Dividendos). Na bolsa, muitas empresas pagam dividendos altos apenas porque a cota√ß√£o despencou (o chamado \"Value Trap\" ou Armadilha de Valor).\n\nComo ler: Este painel s√≥ lista empresas que pagaram mais de 6% de dividendos nos √∫ltimos 12 meses E que ainda possuem Margem de Seguran√ßa positiva (est√£o baratas).\nExemplo Pr√°tico: A empresa \"X\" est√° pagando 20% de dividendo, mas o rob√¥ classificou como \"CARO / AFASTAR\". Por qu√™? Porque ela est√° sendo negociada acima do que vale. Se voc√™ comprar, ganha 20% de dividendo, mas a cota√ß√£o pode cair 40% no dia seguinte. Aqui s√≥ entram as \"Vacas Leiteiras\" que est√£o em promo√ß√£o.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 16,
        "x": 0,
        "y": 12
      },
      "id": 5,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGRES}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT \r\n  recomendacao as \"Status\",\r\n  ticker as \"A√ß√£o\",\r\n  dividendo_ultimos12_meses as \"Yield (% a.a)\",\r\n  margem_seguranca as \"Margem Desconto (%)\",\r\n  TO_CHAR(data_atualizacao, 'DD/MM/YYYY HH24:MI') as \"√öltima Leitura\"\r\nFROM acao\r\nWHERE dividendo_ultimos12_meses > 6 AND margem_seguranca > 0\r\nORDER BY \r\n  CASE WHEN recomendacao LIKE '%COMPRA FORTE%' THEN 1 ELSE 2 END,\r\n  dividendo_ultimos12_meses DESC;\r\n--LIMIT 10;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "üêÑ Vacas Leiteiras (Altos Dividendos + Desconto)",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "afei7jijkor9cc"
      },
      "description": "O que √©: Uma vis√£o panor√¢mica (Top-Down) de como o algoritmo est√° enxergando a bolsa de valores neste exato segundo.\n\nComo ler: Serve para validar a tese do \"Term√¥metro\" ao lado. Se a grande maioria da pizza estiver Verde/Dourada (\"Compra Forte\" e \"Boa Op√ß√£o\"), significa que h√° uma liquida√ß√£o generalizada na bolsa. Se a fatia Vermelha (\"Caro\") for a maior, significa que o mercado subiu demais e est√° dif√≠cil encontrar pechinchas seguras.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": []
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "CILADA (Preju√≠zo/Sem Liquidez)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "BOA OP√á√ÉO üü¢"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "COMPRA FORTE üöÄ"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "CARO / AFASTAR üî¥"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 12
      },
      "id": 2,
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGRES}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT recomendacao as \"Status\", count(ticker) as \"Quantidade\" \r\nFROM acao \r\nGROUP BY recomendacao \r\nORDER BY \"Quantidade\" DESC;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "üéØ Radar de Sentimento",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "afei7jijkor9cc"
      },
      "description": "O que √©: M√©trica operacional de confiabilidade (Health Check) do motor de raspagem de dados (Python) e do mensageiro (Kafka).\n\nComo ler: A B3 possui cerca de 400 empresas listadas, mas nosso rob√¥ possui um filtro de liquidez: ele descarta \"micos\" (empresas falidas ou sem negocia√ß√£o di√°ria).\nExemplo Pr√°tico: Se este n√∫mero estiver entre 150 e 250, o rob√¥ filtrou as melhores empresas com sucesso. Se este n√∫mero for 0, significa que a conex√£o com a B3 falhou ou o rob√¥ Python est√° desligado.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 20
      },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGRES}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT count(ticker) as \"Total\" FROM acao;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "üìä A√ß√µes Analisadas",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "afei7jijkor9cc"
      },
      "description": "O que √©: O sensor de \"Gan√¢ncia e Medo\" da B3. Ele calcula a m√©dia do desconto (Margem de Seguran√ßa) de todas as empresas lucrativas da bolsa brasileira no dia de hoje.\n\nComo ler: > üü¢ Acima de 15%: Mercado em p√¢nico ou pessimista. As empresas est√£o muito baratas na m√©dia. Cen√°rio ideal para ir √†s compras.\nüü° Entre 0% e 15%: Mercado neutro, pagando o pre√ßo justo hist√≥rico.\nüî¥ Abaixo de 0% (Negativo): Mercado euf√≥rico e caro (Bolha). Na m√©dia, os investidores est√£o pagando mais caro do que o patrim√¥nio das empresas justifica. Hora de ter cautela.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red"
              },
              {
                "color": "green",
                "value": 15
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 20
      },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGRES}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT avg(margem_seguranca) as \"M√©dia (%)\" \r\nFROM acao \r\nWHERE pl > 0;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "üå°Ô∏è Margem M√©dia (Mercado)",
      "type": "stat"
    }
  ],
  "refresh": "1m",
  "schemaVersion": 39,
  "tags": [],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "SRE Lab - A√ß√µes B3 (Value Investing)",
  "uid": "bfei9mtnzsd1cc",
  "version": 3,
  "weekStart": ""
}